@page
@inject StateFactory StateFactory
@using Economy.AiInterface.Scope
@model Economy.Web.Pages.BasicsModel
@{
    ViewData["Title"] = "Basics";
    var state = await StateFactory.Get();
}

<h3>Wallets</h3>
<div class="table-responsive">
    <table class="table">
        <thead>
            <tr>
                <th>Wallet</th>
                <th>Latest Inventory</th>
            </tr>
        </thead>
        <tbody>
            @foreach (var entity in state.Repositories.Wallets.GetAll().OrderBy(x => x.Id))
            {
                <tr>
                    <td>@(entity.ToDetails(state.Repositories))</td>
                    <td>@state.Repositories.WalletAudits.GetAll().Where(x => x.WalletId == entity.Id).OrderByDescending(x => x.CheckDateAndTime).ThenByDescending(x => x.Id).FirstOrDefault()?.Amounts.ToDetails(state.Repositories)</td>
                </tr>
            }
        </tbody>
    </table>
</div>

<h3>Currencies</h3>
<ul>
    @foreach (var entity in state.Repositories.Currencies.GetAll().OrderBy(x => x.Id))
    {
        <li>
            @(entity.ToDetails(state.Repositories))
        </li>
    }
</ul>

<h3>Categories</h3>
<ul>
    @foreach (var entity in state.Repositories.Categories.GetAll().OrderBy(x => x.Id))
    {
        <li>
            @(entity.ToDetails(state.Repositories))
        </li>
    }
</ul>